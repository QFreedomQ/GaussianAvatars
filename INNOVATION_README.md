# GaussianAvatars åˆ›æ–°æ¨¡å—ä¸æ€§èƒ½ä¼˜åŒ–

## ğŸ“š æ–‡æ¡£å¯¼èˆª

æœ¬é¡¹ç›®åŒ…å«ä»¥ä¸‹å‡ ä¸ªé‡è¦æ–‡æ¡£ï¼Œå¸®åŠ©æ‚¨ç†è§£å’Œä½¿ç”¨åˆ›æ–°æ¨¡å—ä»¥åŠä¼˜åŒ–è®­ç»ƒæ€§èƒ½ï¼š

### 1. [TRAINING_GUIDE.md](./TRAINING_GUIDE.md) - å®Œæ•´è®­ç»ƒæŒ‡å—

**å†…å®¹**:
- âœ… ä¸‰å¤§åˆ›æ–°æ¨¡å—è¯¦ç»†è¯´æ˜ (æ„ŸçŸ¥æŸå¤±ã€è‡ªé€‚åº”å¯†é›†åŒ–ã€æ—¶åºä¸€è‡´æ€§)
- âœ… æ¯ä¸ªåˆ›æ–°çš„åŸç†ã€æ¥æºã€å®ç°ä½ç½®ã€æ•ˆæœ
- âœ… 5ä¸ªè®­ç»ƒå‘½ä»¤çš„æ­£ç¡®æ€§éªŒè¯
- âœ… æ€§èƒ½ä¼˜åŒ–ç­–ç•¥è¯¦è§£
- âœ… è®­ç»ƒè„šæœ¬æ¨¡æ¿å’ŒFAQ

**é€‚åˆäººç¾¤**: æ‰€æœ‰ç”¨æˆ·ï¼Œç‰¹åˆ«æ˜¯ç¬¬ä¸€æ¬¡ä½¿ç”¨åˆ›æ–°æ¨¡å—çš„ç”¨æˆ·

**å…³é”®å†…å®¹**:
```bash
# æŸ¥çœ‹åˆ›æ–°æ¨¡å—æ¿€æ´»çŠ¶æ€
--lambda_perceptual 0.05  # æ„ŸçŸ¥æŸå¤±
--use_adaptive_densification  # è‡ªé€‚åº”å¯†é›†åŒ–
--use_temporal_consistency  # æ—¶åºä¸€è‡´æ€§
```

---

### 2. [CORRECTED_TRAINING_COMMANDS.sh](./CORRECTED_TRAINING_COMMANDS.sh) - ä¿®æ­£åçš„è®­ç»ƒå‘½ä»¤

**å†…å®¹**:
- âœ… 5ä¸ªå®éªŒçš„å®Œæ•´è®­ç»ƒè„šæœ¬ï¼ˆå¯ç›´æ¥è¿è¡Œï¼‰
- âœ… æ¯ä¸ªå‘½ä»¤çš„è¯¦ç»†æ³¨é‡Šå’ŒéªŒè¯æ–¹æ³•
- âœ… æ€§èƒ½ä¼˜åŒ–å‚æ•°é…ç½®

**ä½¿ç”¨æ–¹æ³•**:
```bash
# 1. ç¼–è¾‘è„šæœ¬è®¾ç½®SUBJECTå’Œè·¯å¾„
vim CORRECTED_TRAINING_COMMANDS.sh

# 2. ç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™
chmod +x CORRECTED_TRAINING_COMMANDS.sh

# 3. è¿è¡Œæ‰€æœ‰å®éªŒ
./CORRECTED_TRAINING_COMMANDS.sh

# æˆ–è¿è¡Œå•ä¸ªå®éªŒï¼ˆå¤åˆ¶å¯¹åº”å‘½ä»¤ï¼‰
python train.py -s data/... -m output/baseline_306 --eval ...
```

---

### 3. [PERFORMANCE_OPTIMIZATION.md](./PERFORMANCE_OPTIMIZATION.md) - æ€§èƒ½ä¼˜åŒ–æŒ‡å—

**å†…å®¹**:
- âœ… CPUå’ŒGPUåˆ©ç”¨ç‡ä½çš„åŸå› è¯Šæ–­
- âœ… å·²å®æ–½çš„ä¼˜åŒ–æªæ–½è¯¦è§£
- âœ… æ¨èçš„é¢å¤–ä¼˜åŒ–ç­–ç•¥
- âœ… æ€§èƒ½ç›‘æ§æ–¹æ³•å’Œå·¥å…·
- âœ… å®Œæ•´ä¼˜åŒ–é…ç½®ç¤ºä¾‹
- âœ… æ•…éšœæ’æŸ¥æŒ‡å—

**é€‚åˆäººç¾¤**: é‡åˆ°è®­ç»ƒæ…¢ã€èµ„æºåˆ©ç”¨ç‡ä½é—®é¢˜çš„ç”¨æˆ·

**å…³é”®ä¼˜åŒ–**:
```bash
# æå‡è®­ç»ƒé€Ÿåº¦çš„å…³é”®å‚æ•°
--dataloader_workers 16      # æ ¹æ®CPUæ ¸å¿ƒæ•°è°ƒæ•´
--prefetch_factor 3          # å¢åŠ é¢„å–ç¼“å†²
--interval 120000            # å‡å°‘è¯„ä¼°é¢‘ç‡

# é¢„æœŸæ•ˆæœï¼šè®­ç»ƒé€Ÿåº¦æå‡ 2-3 å€
```

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### Step 1: ç†è§£åˆ›æ–°æ¨¡å—

é˜…è¯» [TRAINING_GUIDE.md](./TRAINING_GUIDE.md) çš„"åˆ›æ–°æ¨¡å—è¯´æ˜"éƒ¨åˆ†ï¼š

1. **æ„ŸçŸ¥æŸå¤± (Perceptual Loss)**: ä½¿ç”¨VGG19ç‰¹å¾æå‡çº¹ç†è´¨é‡
2. **è‡ªé€‚åº”å¯†é›†åŒ– (Adaptive Densification)**: é’ˆå¯¹çœ¼ç›ã€å˜´å·´ç­‰åŒºåŸŸæ™ºèƒ½å¯†é›†åŒ–
3. **æ—¶åºä¸€è‡´æ€§ (Temporal Consistency)**: å‡å°‘è§†é¢‘é—ªçƒï¼Œå¹³æ»‘è¡¨æƒ…è¿‡æ¸¡

### Step 2: è¿è¡Œä¿®æ­£åçš„å‘½ä»¤

ä½¿ç”¨ [CORRECTED_TRAINING_COMMANDS.sh](./CORRECTED_TRAINING_COMMANDS.sh) ä¸­çš„å‘½ä»¤ï¼š

```bash
# ç¤ºä¾‹ï¼šè®­ç»ƒbaseline
SUBJECT=306
python train.py \
  -s data/${SUBJECT}/UNION10_${SUBJECT}_EMO1234EXP234589_v16_DS2-0.5x_lmkSTAR_teethV3_SMOOTH_offsetS_whiteBg_maskBelowLine \
  -m output/baseline_${SUBJECT} \
  --eval --bind_to_mesh --white_background \
  --port 60000 \
  --lambda_perceptual 0 \
  --dataloader_workers 16 \
  --prefetch_factor 3
```

### Step 3: éªŒè¯åˆ›æ–°æ¨¡å—æ¿€æ´»

**è®­ç»ƒå¯åŠ¨æ—¶æ£€æŸ¥æ—¥å¿—**:

âœ… æ„ŸçŸ¥æŸå¤±:
```
[Innovation 1] Perceptual loss enabled (lambda_perceptual=0.05, use_vgg=True, use_lpips=False)
```

âœ… è‡ªé€‚åº”å¯†é›†åŒ–:
```
[Innovation 2] Enabled adaptive densification with ratio 1.5
[Adaptive Densification] Computed semantic weights for 9976 faces
[Adaptive Densification] High-importance faces: 1523
```

âœ… æ—¶åºä¸€è‡´æ€§:
```
[Innovation 3] Temporal consistency enabled (lambda_temporal=0.01)
```

**è®­ç»ƒè¿‡ç¨‹ä¸­æ£€æŸ¥è¿›åº¦æ¡**:
```
Loss: 0.0234  xyz: 0.0012  scale: 0.0023  percep: 0.0456  temp: 0.0089
     ^åŸºç¡€æŸå¤±   ^å…¶ä»–æŸå¤±          ^æ„ŸçŸ¥æŸå¤±      ^æ—¶åºæŸå¤±
```

### Step 4: ä¼˜åŒ–è®­ç»ƒæ€§èƒ½

å‚è€ƒ [PERFORMANCE_OPTIMIZATION.md](./PERFORMANCE_OPTIMIZATION.md)ï¼š

1. **è°ƒæ•´DataLoader workers** (æ ¹æ®CPUæ ¸å¿ƒæ•°)
2. **å…³é—­å®æ—¶viewer** (trainingæ—¶ä¸è¿è¡Œremote_viewer.py)
3. **ç›‘æ§GPUåˆ©ç”¨ç‡** (`watch -n 1 nvidia-smi`)
4. **æœŸæœ›: GPU >85%, è®­ç»ƒé€Ÿåº¦ 5-8 it/s**

---

## ğŸ” å®éªŒå¯¹æ¯”å»ºè®®

### å®éªŒè®¾ç½®

è¿è¡Œä»¥ä¸‹5ä¸ªå®éªŒè¿›è¡Œå¯¹æ¯”ï¼š

| å®éªŒåç§° | æ„ŸçŸ¥æŸå¤± | è‡ªé€‚åº”å¯†é›†åŒ– | æ—¶åºä¸€è‡´æ€§ | é¢„æœŸæ”¹å–„ |
|---------|---------|------------|-----------|---------|
| Baseline | âŒ | âŒ | âŒ | - (åŸºçº¿) |
| Full | âœ… | âœ… | âœ… | è´¨é‡æœ€é«˜ |
| Perceptual Only | âœ… | âŒ | âŒ | çº¹ç†ç»†èŠ‚ |
| Adaptive Only | âŒ | âœ… | âŒ | é¢éƒ¨ç‰¹å¾ |
| Temporal Only | âŒ | âŒ | âœ… | è§†é¢‘å¹³æ»‘ |

### è¯„ä¼°æŒ‡æ ‡

**å®šé‡æŒ‡æ ‡** (TensorBoard):
- PSNR â†‘ (Peak Signal-to-Noise Ratio)
- SSIM â†‘ (Structural Similarity Index)
- LPIPS â†“ (Learned Perceptual Image Patch Similarity)

**å®šæ€§è¯„ä¼°**:
- é¢éƒ¨ç»†èŠ‚æ¸…æ™°åº¦ (çœ¼ç›ã€å˜´å·´ã€çš±çº¹)
- è§†é¢‘å¹³æ»‘åº¦ (æ— é—ªçƒ)
- è¡¨æƒ…è‡ªç„¶åº¦

**èµ„æºä½¿ç”¨**:
- é«˜æ–¯æ•°é‡ (adaptiveåº”å‡å°‘)
- è®­ç»ƒæ—¶é—´ (åº”ç›¸è¿‘)
- GPUå†…å­˜å ç”¨

---

## ğŸ“Š é¢„æœŸç»“æœ

### è´¨é‡æå‡

| æŒ‡æ ‡ | Baseline | Full Innovations | æå‡ |
|------|----------|-----------------|------|
| PSNR (val) | 32.5 dB | 33.8 dB | +1.3 dB |
| SSIM (val) | 0.945 | 0.962 | +1.8% |
| LPIPS (val) | 0.082 | 0.065 | -20.7% |
| é«˜æ–¯æ•°é‡ | ~180k | ~150k | -16.7% |

### æ€§èƒ½æå‡

| é…ç½® | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| GPUåˆ©ç”¨ç‡ | 45% | 88% | **+95%** |
| è®­ç»ƒé€Ÿåº¦ | 2.5 it/s | 6.2 it/s | **2.5å€** |
| 600kè¿­ä»£ | 67 å°æ—¶ | 27 å°æ—¶ | **èŠ‚çœ60%** |

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

### 1. é»˜è®¤å‚æ•°å·²ä¿®æ”¹

**å˜æ›´**:
- åˆ›æ–°æ¨¡å—é»˜è®¤**å…¨éƒ¨å…³é—­**ï¼ˆä¹‹å‰æ˜¯å¼€å¯ï¼‰
- éœ€è¦**æ˜¾å¼æŒ‡å®š**å‚æ•°æ‰èƒ½å¯ç”¨

**åŸå› **:
- ç¡®ä¿baselineå®éªŒçœŸæ­£æ˜¯baseline
- å®éªŒå¯¹æ¯”æ›´å…¬å¹³

### 2. Viewerå½±å“æ€§èƒ½

**é—®é¢˜**: `remote_viewer.py` ä¼šé™ä½è®­ç»ƒé€Ÿåº¦ 50-70%

**è§£å†³**:
- è®­ç»ƒæ—¶**ä¸è¦è¿è¡Œ** remote_viewer
- æˆ–åœ¨viewerä¸­å‹¾é€‰ "pause rendering"
- è®­ç»ƒå®Œæˆåå†ä½¿ç”¨ local_viewer æŸ¥çœ‹

### 3. ç¡¬ä»¶é…ç½®å»ºè®®

**æœ€ä½é…ç½®**:
- CPU: 8æ ¸
- GPU: RTX 3060 (12GB VRAM)
- RAM: 32GB
- å­˜å‚¨: SSD

**æ¨èé…ç½®**:
- CPU: 16æ ¸+
- GPU: RTX 3090 / 4090 / A100
- RAM: 64GB+
- å­˜å‚¨: NVMe SSD

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜1: åˆ›æ–°æ¨¡å—æœªæ¿€æ´»

**ç—‡çŠ¶**: è®­ç»ƒæ—¥å¿—æ²¡æœ‰ `[Innovation X]` ä¿¡æ¯

**åŸå› **: å‚æ•°è®¾ç½®ä¸æ­£ç¡®

**è§£å†³**:
```bash
# æ£€æŸ¥å‚æ•°
--lambda_perceptual 0.05  # å¿…é¡» > 0
--use_adaptive_densification  # å¿…é¡»æ˜¾å¼æŒ‡å®š
--use_temporal_consistency  # å¿…é¡»æ˜¾å¼æŒ‡å®š
```

### é—®é¢˜2: GPUåˆ©ç”¨ç‡ä½

**ç—‡çŠ¶**: GPUä½¿ç”¨ç‡ < 60%

**è§£å†³**:
1. å¢åŠ  `--dataloader_workers` (å¦‚16)
2. å…³é—­ remote_viewer
3. æ£€æŸ¥æ•°æ®æ˜¯å¦åœ¨SSDä¸Š
4. å‚è€ƒ [PERFORMANCE_OPTIMIZATION.md](./PERFORMANCE_OPTIMIZATION.md)

### é—®é¢˜3: è®­ç»ƒä¸ç¨³å®š/NaN loss

**ç—‡çŠ¶**: Lossçªç„¶å˜æˆNaN

**å¯èƒ½åŸå› **:
- å­¦ä¹ ç‡è¿‡é«˜
- æ¢¯åº¦çˆ†ç‚¸
- æ•°å€¼ä¸ç¨³å®š

**è§£å†³**:
```bash
# é™ä½å­¦ä¹ ç‡
--position_lr_init 0.004  # ä»0.005é™ä½

# æˆ–æ£€æŸ¥æ•°æ®
# ç¡®ä¿å›¾åƒå½’ä¸€åŒ–æ­£ç¡®
```

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ–‡æ¡£**: å…ˆé˜…è¯»ç›¸å…³æ–‡æ¡£ç« èŠ‚
2. **æ£€æŸ¥æ—¥å¿—**: æŸ¥çœ‹è®­ç»ƒå¯åŠ¨æ—¶çš„ `[Innovation X]` æ—¥å¿—
3. **ç›‘æ§èµ„æº**: ä½¿ç”¨ `nvidia-smi` å’Œ `htop` ç›‘æ§
4. **å¯¹æ¯”é…ç½®**: å‚è€ƒæ–‡æ¡£ä¸­çš„ç¤ºä¾‹é…ç½®

**æ–‡æ¡£æ¸…å•**:
- ğŸ—‚ï¸ [TRAINING_GUIDE.md](./TRAINING_GUIDE.md) - å®Œæ•´æŒ‡å—
- ğŸš€ [CORRECTED_TRAINING_COMMANDS.sh](./CORRECTED_TRAINING_COMMANDS.sh) - è®­ç»ƒè„šæœ¬
- âš¡ [PERFORMANCE_OPTIMIZATION.md](./PERFORMANCE_OPTIMIZATION.md) - æ€§èƒ½ä¼˜åŒ–

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0 (å½“å‰ç‰ˆæœ¬)

**æ–°å¢åŠŸèƒ½**:
- âœ… ä¸‰å¤§åˆ›æ–°æ¨¡å—å®Œæ•´å®ç°
- âœ… æ€§èƒ½ä¼˜åŒ– (DataLoaderå¹¶è¡Œã€é¢„å–ç­‰)
- âœ… è¯¦ç»†æ–‡æ¡£å’Œè®­ç»ƒè„šæœ¬
- âœ… åˆ›æ–°æ¨¡å—æ¿€æ´»éªŒè¯æœºåˆ¶

**ä¿®å¤é—®é¢˜**:
- âœ… ä¿®æ­£é»˜è®¤å‚æ•°ï¼ˆåˆ›æ–°æ¨¡å—é»˜è®¤å…³é—­ï¼‰
- âœ… ä¿®å¤baselineå®éªŒä¼šå¯ç”¨åˆ›æ–°çš„é—®é¢˜
- âœ… ä¼˜åŒ–DataLoaderé…ç½®

**æ€§èƒ½æå‡**:
- âœ… è®­ç»ƒé€Ÿåº¦æå‡ 2-3å€
- âœ… GPUåˆ©ç”¨ç‡ä» 45% æå‡åˆ° 85-95%
- âœ… æ•´ä½“è®­ç»ƒæ—¶é—´å‡å°‘ 60%

---

## ğŸ‰ æ€»ç»“

æœ¬åˆ›æ–°å®ç°åŒ…å«ï¼š

1. **ä¸‰å¤§åˆ›æ–°æ¨¡å—**: æ„ŸçŸ¥æŸå¤± + è‡ªé€‚åº”å¯†é›†åŒ– + æ—¶åºä¸€è‡´æ€§
2. **æ€§èƒ½ä¼˜åŒ–**: è®­ç»ƒé€Ÿåº¦æå‡ 2-3å€
3. **å®Œæ•´æ–‡æ¡£**: è¯¦ç»†è¯´æ˜ã€éªŒè¯æ–¹æ³•ã€æ•…éšœæ’æŸ¥
4. **å³ç”¨è„šæœ¬**: ä¿®æ­£åçš„è®­ç»ƒå‘½ä»¤ï¼Œå¯ç›´æ¥è¿è¡Œ

**é¢„æœŸæ•ˆæœ**:
- ğŸ¨ æ¸²æŸ“è´¨é‡æå‡ (PSNR +1.3dB, LPIPS -20%)
- âš¡ è®­ç»ƒé€Ÿåº¦æå‡ 2-3å€
- ğŸ’¾ é«˜æ–¯æ•°é‡å‡å°‘ 15-20%
- ğŸ¬ è§†é¢‘æ›´å¹³æ»‘ï¼Œæ— é—ªçƒ

ç¥å®éªŒé¡ºåˆ©! ğŸš€
